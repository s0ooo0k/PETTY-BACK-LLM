<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/defaultLayout}">
<head>
    <title>PETTY ê²Œì‹œê¸€ ìƒì„¸</title>
</head>

<!-- í˜ì´ì§€ë³„ CSS ì¶”ê°€ -->
<th:block layout:fragment="css">
    <style>
        /* í°íŠ¸ ì •ì˜ */
        @font-face {
            font-family: 'HakgyoansimDunggeunmisoTTF-B';
            src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/2408-5@1.0/HakgyoansimDunggeunmisoTTF-B.woff2') format('woff2');
            font-weight: 700;
            font-style: normal;
        }

        /* CSS ë³€ìˆ˜ */
        :root {
            --background-color: #FFF0DC;
            --text-color: #4B352A;
            --point-color: #9EBC8A;
            --accent-color: #D76C82;
            --secondary-text-color: #7A5B4C;
            --card-bg-color: #FFFFFF;
            --input-border-color: #D3B8AE;
            --button-hover-color: #c45b73;
            --border-radius-lg: 20px;
            --border-radius-md: 12px;
            --border-radius-sm: 8px;
            --box-shadow-light: 0 4px 15px rgba(0, 0, 0, 0.08);
            --box-shadow-cute: 0 8px 20px rgba(215, 108, 130, 0.2);
        }

        body {
            font-family: 'HakgyoansimDunggeunmisoTTF-B', 'Noto Sans KR', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 25px;
            background-color: var(--card-bg-color);
            box-shadow: var(--box-shadow-light);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom-left-radius: var(--border-radius-lg);
            border-bottom-right-radius: var(--border-radius-lg);
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 8px;
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
        }

        .logo-container img {
            height: 40px;
            width: auto;
            vertical-align: middle;
        }

        .logo-container h1 {
            color: var(--accent-color);
            font-size: 1.8em;
            margin: 0;
        }

        .logo-container a {
            text-decoration: none;
            color: inherit;
        }

        .menu-icon {
            width: 30px;
            height: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            cursor: pointer;
            z-index: 1001;
            position: relative;
        }

        .menu-icon span {
            display: block;
            width: 100%;
            height: 3px;
            background-color: var(--text-color);
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .account-btn-div {
            display: flex;
            gap: 15px;
        }

        .account-btn-div a {
            text-decoration: none;
            color: var(--secondary-text-color);
            font-weight: bold;
            padding: 8px 12px;
            border-radius: var(--border-radius-md);
            transition: all 0.3s ease;
        }

        .account-btn-div a:hover {
            background-color: var(--point-color);
            color: white;
        }

        /* ì‚¬ì´ë“œ ë©”ë‰´ */
        .side-menu {
            position: fixed;
            top: 0;
            left: -250px;
            width: 220px;
            height: 100%;
            background-color: var(--point-color);
            padding-top: 80px;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.1);
            transition: left 0.3s ease;
            z-index: 999;
            border-top-right-radius: var(--border-radius-lg);
            border-bottom-right-radius: var(--border-radius-lg);
            box-sizing: border-box;
        }

        .side-menu.open {
            left: 0;
        }

        .side-menu nav {
            display: flex;
            flex-direction: column;
            padding: 20px;
        }

        .side-menu a {
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            margin-bottom: 10px;
            border-radius: var(--border-radius-md);
            transition: background-color 0.3s ease;
            font-size: 1.1em;
            font-weight: bold;
        }

        .side-menu a:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        /* ë©”ì¸ ì»¨í…ì¸  */
        main {
            flex-grow: 1;
            padding: 40px 25px;
            max-width: 900px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            color: var(--secondary-text-color);
            font-size: 0.9em;
            text-decoration: none;
            margin-bottom: 20px;
            transition: color 0.2s ease;
        }

        .back-link:hover {
            color: var(--accent-color);
        }

        .back-link svg {
            width: 16px;
            height: 16px;
        }

        /* ê²Œì‹œê¸€ ì¹´ë“œ */
        .post-card {
            background: var(--card-bg-color);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-light);
            overflow: hidden;
            margin-bottom: 30px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .post-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--box-shadow-cute);
        }

        .post-header {
            padding: 25px 30px 20px;
            border-bottom: 1px solid var(--input-border-color);
            position: relative;
        }

        .post-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--accent-color);
        }

        .post-type {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 30px;
            font-size: 0.8em;
            font-weight: 600;
            color: white;
            margin-bottom: 15px;
        }

        .post-type[data-type="DOG"],
        .post-type[data-type="ê°•ì•„ì§€"] { background: #4dabf7; }
        .post-type[data-type="CAT"],
        .post-type[data-type="ê³ ì–‘ì´"] { background: #69db7c; }
        .post-type[data-type="HAMSTER"],
        .post-type[data-type="í–„ìŠ¤í„°"] { background: #b197fc; }
        .post-type[data-type="PARROT"],
        .post-type[data-type="ì•µë¬´ìƒˆ"] { background: #ff8787; }
        .post-type[data-type="RABBIT"],
        .post-type[data-type="í† ë¼"] { background: #ffd43b; }
        .post-type[data-type="REPTILE"],
        .post-type[data-type="íŒŒì¶©ë¥˜"] { background: #63e6be; }
        .post-type[data-type="OTHER"],
        .post-type[data-type="ê¸°íƒ€"] { background: #ffa94d; }

        .post-title {
            margin: 0 0 15px 0;
            font-size: 2em;
            font-weight: 700;
            color: var(--text-color);
        }

        .post-meta {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
            color: var(--secondary-text-color);
            font-size: 0.9em;
        }

        .post-meta > span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .post-meta svg {
            width: 16px;
            height: 16px;
        }

        .post-content {
            padding: 30px;
        }

        .post-content p {
            margin: 0 0 16px 0;
            font-size: 1.1em;
            line-height: 1.7;
            color: var(--text-color);
        }

        .post-images {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .post-images img {
            width: 100%;
            border-radius: var(--border-radius-md);
            box-shadow: var(--box-shadow-light);
            transition: transform 0.3s ease;
        }

        .post-images img:hover {
            transform: scale(1.03);
        }

        .post-images.single-image-container {
            grid-template-columns: 1fr;
            justify-items: center;
        }

        .single-image {
            max-height: 500px;
            object-fit: contain;
            max-width: 100%;
        }

        .post-info {
            margin-top: 25px;
            background: rgba(158, 188, 138, 0.1);
            padding: 20px;
            border-radius: var(--border-radius-md);
            border-left: 4px solid var(--point-color);
        }

        .post-info p {
            margin: 8px 0;
            font-size: 1em;
            color: var(--text-color);
        }

        .post-info p strong {
            font-weight: 600;
            color: var(--accent-color);
            margin-right: 8px;
        }

        .post-status { display: inline-block; padding: 2px 8px;
                        border-radius: 15px; font-size: 0.7em;
                        font-weight: 600; margin-left: 8px; vertical-align: middle; }

        .post-status.resolved {
            background-color: var(--point-color);
            color: white;
        }

        .post-status.unsolved {
            background-color: var(--accent-color);
            color: white;
        }

        .action-buttons {
            display: flex;
            justify-content: space-between;
            margin: 25px 0;
            flex-wrap: wrap;
            gap: 15px;
        }

        .action-buttons .left-buttons,
        .action-buttons .right-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 30px;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            border: none;
            font-family: inherit;
            text-decoration: none;
        }

        .btn svg {
            width: 18px;
            height: 18px;
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--button-hover-color);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--input-border-color);
            color: var(--secondary-text-color);
        }

        .btn-secondary:hover {
            background-color: var(--secondary-text-color);
            color: white;
            transform: translateY(-2px);
        }

        .btn-danger {
            background-color: #ff6b6b;
            color: white;
        }

        .btn-danger:hover {
            background-color: #fa5252;
            transform: translateY(-2px);
        }

        .btn-like {
            background-color: rgba(215, 108, 130, 0.1);
            color: var(--accent-color);
            border: 2px solid var(--accent-color);
        }

        .btn-like:hover {
            background-color: var(--accent-color);
            color: white;
        }

        /* ëŒ“ê¸€ ì„¹ì…˜ */
        .comment-section {
            background: var(--card-bg-color);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-light);
            padding: 25px 30px;
            margin-bottom: 50px;
            position: relative;
        }

        .comment-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--point-color);
            border-radius: var(--border-radius-lg) var(--border-radius-lg) 0 0;
        }

        .comment-section h3 {
            margin: 0 0 20px 0;
            font-size: 1.3em;
            font-weight: 700;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .comment-section h3 svg {
            width: 20px;
            height: 20px;
        }

        .comment-form {
            margin-bottom: 30px;
        }

        .comment-form textarea {
            width: 100%;
            height: 100px;
            padding: 15px;
            border: 2px solid var(--input-border-color);
            border-radius: var(--border-radius-md);
            font-size: 1em;
            resize: none;
            margin-bottom: 15px;
            box-sizing: border-box;
            transition: border-color 0.2s ease;
            font-family: inherit;
            color: var(--text-color);
        }

        .comment-form textarea:focus {
            border-color: var(--accent-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(215, 108, 130, 0.2);
        }

        .comment-form textarea::placeholder {
            color: var(--secondary-text-color);
        }

        .comment-form button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 10px 25px;
            font-size: 0.9em;
            font-weight: 600;
            cursor: pointer;
            float: right;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .comment-form button:hover {
            background-color: var(--button-hover-color);
            transform: translateY(-2px);
        }

        .comment-form button:disabled {
            background-color: var(--input-border-color);
            color: var(--secondary-text-color);
            cursor: not-allowed;
            transform: none;
        }

        .comment-list {
            margin-top: 20px;
        }

        .comment {
            padding: 15px 0;
            border-bottom: 1px solid var(--input-border-color);
        }

        .comment:last-child {
            border-bottom: none;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .comment-author {
            font-weight: 600;
            color: var(--accent-color);
        }

        .comment-date {
            font-size: 0.8em;
            color: var(--secondary-text-color);
        }

        .comment-content {
            color: var(--text-color);
            font-size: 1em;
            line-height: 1.5;
            margin-bottom: 10px;
        }

        .comment-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .comment-actions button {
            background: none;
            border: none;
            font-size: 0.8em;
            color: var(--secondary-text-color);
            cursor: pointer;
            padding: 2px 8px;
            border-radius: 15px;
            transition: all 0.2s ease;
        }

        .comment-actions button:hover {
            color: var(--accent-color);
            background-color: rgba(215, 108, 130, 0.1);
        }

        .comment-edit-form textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--input-border-color);
            border-radius: var(--border-radius-sm);
            font-size: 0.9em;
            margin-bottom: 10px;
            box-sizing: border-box;
            font-family: inherit;
        }

        .comment-edit-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .comment-edit-actions button {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8em;
            cursor: pointer;
            border: none;
            font-family: inherit;
        }

        .comment-edit-actions .btn-save {
            background-color: var(--accent-color);
            color: white;
        }

        .comment-edit-actions .btn-cancel {
            background-color: var(--input-border-color);
            color: var(--secondary-text-color);
        }

        /* í‘¸í„° */
        footer {
            background-color: var(--point-color);
            color: white;
            text-align: center;
            padding: 30px 20px;
            margin-top: auto;
            border-top-left-radius: var(--border-radius-lg);
            border-top-right-radius: var(--border-radius-lg);
            font-size: 1.1em;
            line-height: 1.8;
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.08);
        }

        .paw {
            font-size: 1.3em;
            color: var(--accent-color);
            margin: 0 5px;
        }

        /* ë°˜ì‘í˜• ì²˜ë¦¬ */
        @media (max-width: 768px) {
            .post-header, .post-content {
                padding: 20px;
            }

            .post-images {
                grid-template-columns: 1fr 1fr;
            }

            .action-buttons {
                flex-direction: column;
                gap: 15px;
            }

            .action-buttons .right-buttons {
                justify-content: flex-start;
            }

            .account-btn-div {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .post-meta {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .post-images {
                grid-template-columns: 1fr;
            }
        }
    </style>
</th:block>
<div layout:fragment="content">
    <div class="container">
        <a href="javascript:history.back()" class="back-link">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
        </a>

        <div id="postDetail">
            <!-- ê²Œì‹œê¸€ ë‚´ìš©ì´ AJAXë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
            <div class="post-card">
                <div class="post-header">
                    <span class="post-type" data-type="loading...">ë¡œë”© ì¤‘...</span>
                    <h1 class="post-title">ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤... ğŸ¾</h1>
                    <div class="post-meta">
                            <span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M5.33788 18.3206C5.99897 16.5269 7.77368 15.3111 9.76328 15.6223L11 15.8093C11.6432 15.9331 12.3568 15.9331 13 15.8093L14.2367 15.6223C16.2263 15.3111 18.001 16.5269 18.6621 18.3206C19.0127 19.2521 19.4593 20.4217 19.6682 21.1328C19.8155 21.6127 19.4317 22 18.9222 22H5.07778C4.56833 22 4.18448 21.6127 4.33181 21.1328C4.54065 20.4217 4.98733 19.2521 5.33788 18.3206Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                ë¡œë”© ì¤‘...
                            </span>
                        <span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M11.997 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 11.997 2C6.47429 2 2 6.47715 2 12C2 17.5228 6.47429 22 11.997 22Z" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                ë¡œë”© ì¤‘...
                            </span>
                        <span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.27 2 8.5C2 5.41 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.08C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.41 22 8.5C22 12.27 18.6 15.36 13.45 20.03L12 21.35Z" fill="currentColor"/>
                                </svg>
                                <span id="likeCount">0</span>
                            </span>
                        <span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M20.9955 6.00223C21.0109 6.01746 21.0261 6.0328 21.0411 6.04825L12.8481 12L21.0411 17.9517C21.0261 17.9672 21.0109 17.9825 20.9955 17.9978C20.8955 18.0978 20.7877 18.1469 20.6739 18.1469H3.33268C3.00186 18.1469 2.73438 17.8831 2.73438 17.5565V6.44348C2.73438 6.11686 3.00186 5.85312 3.33268 5.85312H20.6739C20.7877 5.85312 20.8955 5.90224 20.9955 6.00223Z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                <span id="commentCount">0</span>
                            </span>
                    </div>
                </div>

                <div class="post-content">
                    <div class="post-images">
                        <!-- ì´ë¯¸ì§€ê°€ AJAXë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                        <img src="/api/placeholder/400/320" alt="placeholder" class="loading-placeholder">
                    </div>

                    <p>ê²Œì‹œê¸€ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤... ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”! ğŸ•â€ğŸ¦º</p>

                    <div class="post-info">
                        <!-- ì¶”ê°€ ì •ë³´ê°€ AJAXë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                        <p><strong>ğŸ“ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</strong></p>
                    </div>

                    <div class="action-buttons">
                        <div class="left-buttons">
                            <button class="btn btn-like" id="likeBtn">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.27 2 8.5C2 5.41 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.08C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.41 22 8.5C22 12.27 18.6 15.36 13.45 20.03L12 21.35Z" fill="currentColor"/>
                                </svg>
                                ì¢‹ì•„ìš”
                            </button>
                        </div>

                        <div class="right-buttons">
                            <button class="btn btn-secondary" onclick="goToEditPage()">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M15 5L18 8M13 7L5 15V18H8L16 10M13 7L16 4L18 6L15 9L13 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                ìˆ˜ì •í•˜ê¸°
                            </button>
                            <button class="btn btn-danger" onclick="deletePost()">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                ì‚­ì œí•˜ê¸°
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="comment-section">
            <h3>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M20.9955 6.00223C21.0109 6.01746 21.0261 6.0328 21.0411 6.04825L12.8481 12L21.0411 17.9517C21.0261 17.9672 21.0109 17.9825 20.9955 17.9978C20.8955 18.0978 20.7877 18.1469 20.6739 18.1469H3.33268C3.00186 18.1469 2.73438 17.8831 2.73438 17.5565V6.44348C2.73438 6.11686 3.00186 5.85312 3.33268 5.85312H20.6739C20.7877 5.85312 20.8955 5.90224 20.9955 6.00223Z" stroke="currentColor" stroke-width="2"/>
                </svg>
                ëŒ“ê¸€ ğŸ’¬
            </h3>

            <form id="commentForm" class="comment-form">
                <textarea id="commentContent" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš” ğŸ˜Š"></textarea>
                <button type="submit">ë“±ë¡</button>
                <div style="clear: both;"></div>
            </form>

            <div id="commentList" class="comment-list">
                <!-- ëŒ“ê¸€ì´ AJAXë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                <div class="comment">
                    <div class="comment-header">
                        <span class="comment-author">ëŒ“ê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
                        <span class="comment-date">ë¡œë”©ì¤‘</span>
                    </div>
                    <div class="comment-content">ëŒ“ê¸€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆì–´ìš”! ğŸ¾</div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- í˜ì´ì§€ë³„ JavaScript ì¶”ê°€ -->
<th:block layout:fragment="script">
    <script th:inline="javascript">
        const postId = new URLSearchParams(location.search).get("id");

    // ğŸ” ë¡œê·¸ì¸ ì²´í¬ í•¨ìˆ˜ (ì¿ í‚¤ ê¸°ë°˜)
    function isLoggedIn() {
        return true; // ì‹¤ì œ ì²´í¬ëŠ” getCurrentUser()ì—ì„œ
    }

    // ğŸ” í˜„ì¬ ë¡œê·¸ì¸ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ì¿ í‚¤ ê¸°ë°˜)
    async function getCurrentUser() {
        try {
            const res = await fetch('/api/users/me', {
                credentials: 'include' // ì¿ í‚¤ë¥¼ í¬í•¨í•´ì„œ ìš”ì²­
            });

            if (res.ok) {
                return await res.json();
            } else if (res.status === 401) {
                return null; // ë¡œê·¸ì¸ ì•ˆë¨
            }
        } catch (err) {
            console.error('ì‚¬ìš©ì ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨:', err);
        }
        return null;
    }

    async function fetchPostDetail() {
        try {
            const res = await fetch(`/api/posts/${postId}`);
            if (!res.ok) throw new Error("ê²Œì‹œê¸€ ì¡°íšŒ ì‹¤íŒ¨");

            const post = await res.json();

            // ğŸ”¥ ë¨¼ì € í˜„ì¬ ì‚¬ìš©ì ì •ë³´ë¥¼ í™•ì¸ (í† í° ìœ íš¨ì„± ê²€ì¦)
            const currentUser = await getCurrentUser();
            const loggedIn = !!currentUser;  // getCurrentUser ê²°ê³¼ë¡œ ë¡œê·¸ì¸ ìƒíƒœ íŒë‹¨

            const isOwner = currentUser && (currentUser.username === post.userName);
            const container = document.getElementById("postDetail");

            let petTypeLabel = '';

            // PetType ì˜ë¬¸ ê°’ì„ í•œê¸€ë¡œ ë³€í™˜ (ë°±ì—”ë“œ ì‘ë‹µì— ë”°ë¼ ì¡°ì • í•„ìš”)
            switch(post.petType) {
                case 'DOG': petTypeLabel = 'ê°•ì•„ì§€'; break;
                case 'CAT': petTypeLabel = 'ê³ ì–‘ì´'; break;
                case 'RABBIT': petTypeLabel = 'í† ë¼'; break;
                case 'HAMSTER': petTypeLabel = 'í–„ìŠ¤í„°'; break;
                case 'PARROT': petTypeLabel = 'ì•µë¬´ìƒˆ'; break;
                case 'REPTILE': petTypeLabel = 'íŒŒì¶©ë¥˜'; break;
                case 'OTHER': petTypeLabel = 'ê¸°íƒ€'; break;
                default: petTypeLabel = post.petType;
            }

            // ì´ë¯¸ì§€ HTML ìƒì„±
            const imageHtml = Array.isArray(post.images) && post.images.length > 0
                ? `<div class="post-images ${post.images.length === 1 ? 'single-image-container' : ''}">
                    ${post.images
                        .sort((a, b) => a.ordering - b.ordering) // ìˆœì„œ ë³´ì¥
                        .map(img => `<img src="${img.imageUrl}" alt="ì´ë¯¸ì§€" class="${post.images.length === 1 ? 'single-image' : ''}">`)
                        .join('')}
                   </div>`
                : '';

            // ğŸ” ì¢‹ì•„ìš” ë²„íŠ¼ì€ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì—ê²Œë§Œ í‘œì‹œ
            const likeButtonHtml = loggedIn
                ? `<button id="likeBtn" class="btn btn-like">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.27 2 8.5C2 5.41 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.08C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.41 22 8.5C22 12.27 18.6 15.36 13.45 20.03L12 21.35Z" fill="currentColor"/>
                    </svg>
                    ì¢‹ì•„ìš”
                  </button>`
                : '';

            // ê²Œì‹œê¸€ ì¶”ê°€ ì •ë³´ HTML ìƒì„±
            let infoHtml = '';

            if (post.region || post.petName || (post.postType === "QNA" && post.isResolved !== undefined)) {
                infoHtml = `<div class="post-info">`;

                if (post.region) {
                    infoHtml += `<p><strong>ì—¬í–‰ ì¥ì†Œ:</strong> ${post.region}</p>`;
                }

                if (post.petName) {
                    infoHtml += `<p><strong>ë°˜ë ¤ë™ë¬¼ ì´ë¦„:</strong> ${post.petName}</p>`;
                }

                if (post.postType === "QNA" && post.isResolved !== undefined) {
                    infoHtml += `<p>
                        <strong>ì§ˆë¬¸ ìƒíƒœ:</strong>
                        <span class="post-status ${post.isResolved ? 'resolved' : 'unsolved'}">
                            ${post.isResolved ? 'í•´ê²°ë¨' : 'ë¯¸í•´ê²°'}
                        </span>
                    </p>`;
                }

                infoHtml += `</div>`;
            }

            // ğŸ” ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ì€ ê²Œì‹œê¸€ ì‘ì„±ìì—ê²Œë§Œ í‘œì‹œ
            const ownerButtonsHtml = isOwner
                ? `<div class="right-buttons">
                    <button class="btn btn-secondary" onclick="goToEditPage('${post.postType}', ${postId})">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M15 5L18 8M13 7L5 15V18H8L16 10M13 7L16 4L18 6L15 9L13 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        ìˆ˜ì •í•˜ê¸°
                    </button>
                    <button class="btn btn-danger" onclick="deletePost()">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 6H5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M8 6V4C8 3.46957 8.21071 2.96086 8.58579 2.58579C8.96086 2.21071 9.46957 2 10 2H14C14.5304 2 15.0391 2.21071 15.4142 2.58579C15.7893 2.96086 16 3.46957 16 4V6M19 6V20C19 20.5304 18.7893 21.0391 18.4142 21.4142C18.0391 21.7893 17.5304 22 17 22H7C6.46957 22 5.96086 21.7893 5.58579 21.4142C5.21071 21.0391 5 20.5304 5 20V6H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        ì‚­ì œí•˜ê¸°
                    </button>
                  </div>`
                : '';

            // ğŸ” ì•¡ì…˜ ë²„íŠ¼ ì˜ì—­: ì¢‹ì•„ìš”ëŠ” ë¡œê·¸ì¸ ì‚¬ìš©ì, ìˆ˜ì •/ì‚­ì œëŠ” ì‘ì„±ìë§Œ
            const actionButtonsHtml = (loggedIn || isOwner)
                ? `<div class="action-buttons">
                    <div class="left-buttons">
                        ${likeButtonHtml}
                    </div>
                    ${ownerButtonsHtml}
                  </div>`
                : '';

            // ìµœì¢… ê²Œì‹œê¸€ HTML êµ¬ì„±
            container.innerHTML = `
                <div class="post-card">
                    <div class="post-header">
                        <span class="post-type" data-type="${post.petType}">${petTypeLabel}</span>
                        <h1 class="post-title">${post.title}</h1>
                        <div class="post-meta">
                            <span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M5.33788 18.3206C5.99897 16.5269 7.77368 15.3111 9.76328 15.6223L11 15.8093C11.6432 15.9331 12.3568 15.9331 13 15.8093L14.2367 15.6223C16.2263 15.3111 18.001 16.5269 18.6621 18.3206C19.0127 19.2521 19.4593 20.4217 19.6682 21.1328C19.8155 21.6127 19.4317 22 18.9222 22H5.07778C4.56833 22 4.18448 21.6127 4.33181 21.1328C4.54065 20.4217 4.98733 19.2521 5.33788 18.3206Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                ${post.writer}
                            </span>
                            <span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M11.997 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 11.997 2C6.47429 2 2 6.47715 2 12C2 17.5228 6.47429 22 11.997 22Z" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                ${new Date(post.createdAt).toLocaleDateString()}
                            </span>
                            <span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.27 2 8.5C2 5.41 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.08C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.41 22 8.5C22 12.27 18.6 15.36 13.45 20.03L12 21.35Z" fill="currentColor"/>
                                </svg>
                                <span id="likeCount">${post.likeCount || 0}</span>
                            </span>
                            <span>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M20.9955 6.00223C21.0109 6.01746 21.0261 6.0328 21.0411 6.04825L12.8481 12L21.0411 17.9517C21.0261 17.9672 21.0109 17.9825 20.9955 17.9978C20.8955 18.0978 20.7877 18.1469 20.6739 18.1469H3.33268C3.00186 18.1469 2.73438 17.8831 2.73438 17.5565V6.44348C2.73438 6.11686 3.00186 5.85312 3.33268 5.85312H20.6739C20.7877 5.85312 20.8955 5.90224 20.9955 6.00223Z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                <span id="commentCount">${post.commentCount || 0}</span>
                            </span>
                        </div>
                    </div>

                    <div class="post-content">
                        ${imageHtml}
                        <p>${post.content?.replaceAll('\n', '<br>')}</p>
                        ${infoHtml}
                        ${actionButtonsHtml}
                    </div>
                </div>
            `;

            // ì¢‹ì•„ìš” ë²„íŠ¼ ì´ë²¤íŠ¸ ì²˜ë¦¬
            if (loggedIn) {
                const likeBtn = document.getElementById("likeBtn");
                likeBtn?.addEventListener("click", async () => {
                    try {
                        const res = await fetch(`/api/posts/${postId}/like`, {
                            method: 'POST',
                            credentials: 'include' // ì¿ í‚¤ í¬í•¨
                        });

                        if (!res.ok) throw new Error("ì¢‹ì•„ìš” ì‹¤íŒ¨");

                        const result = await res.json();
                        // ğŸ”¥ ì¢‹ì•„ìš” ìˆ˜ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
                        document.getElementById("likeCount").innerText = result.likeCount;
                    } catch (err) {
                        alert("ì¢‹ì•„ìš” ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
                        console.error(err);
                    }
                });
            }

            bindCommentForm(loggedIn);
            await loadComments();
        } catch (err) {
            console.error(err);
            alert("ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }
    }

    function goToEditPage(postType, postId) {
        // ğŸ” ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œì—ë„ ë¡œê·¸ì¸ ì²´í¬
        getCurrentUser().then(currentUser => {
            if (!currentUser) {
                alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
                location.href = "/login";
                return;
            }

            const lowerType = postType.toLowerCase(); // QNA â†’ qna
            location.href = `/posts/${lowerType}/edit?id=${postId}`;
        });
    }

    async function deletePost() {
    // ğŸ” ì‚­ì œ ì‹œì—ë„ ë¡œê·¸ì¸ ì²´í¬
    const currentUser = await getCurrentUser();
    if (!currentUser) {
        alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
        location.href = "/login";
        return;
    }

    if (!confirm("ì´ ê²Œì‹œê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

    try {
        const res = await fetch(`/api/posts/${postId}`, {
            method: 'DELETE',
            credentials: 'include' // ì¿ í‚¤ í¬í•¨
        });

        if (res.ok) {
            const result = await res.json();
            const postType = result.postType; // ğŸ”¥ ì„œë²„ì—ì„œ ë°˜í™˜í•œ ê²Œì‹œê¸€ íƒ€ì…

            alert("ê²Œì‹œê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");

            // ğŸ”¥ í•´ë‹¹ ì¹´í…Œê³ ë¦¬ ë¦¬ìŠ¤íŠ¸ë¡œ ì´ë™
            switch(postType) {
                case 'QNA':
                    window.location.replace("/posts/qna");
                    break;
                case 'REVIEW':
                    window.location.replace("/posts/review");
                    break;
                case 'SHOWOFF':
                    window.location.replace("/posts/showoff");
                    break;
                default:
                    window.location.replace("/");
            }
        } else {
            const error = await res.text();
            alert("ì‚­ì œ ì‹¤íŒ¨: " + error);
        }
    } catch (err) {
        console.error("ì‚­ì œ ì˜¤ë¥˜:", err);
        alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    }
}

    function bindCommentForm(isUserLoggedIn) {
        const form = document.getElementById("commentForm");
        const commentTextarea = document.getElementById("commentContent");

        if (!isUserLoggedIn) {
            // ğŸ” ë¡œê·¸ì¸í•˜ì§€ ì•Šì•˜ìœ¼ë©´ ëŒ“ê¸€ í¼ì„ ë¹„í™œì„±í™”
            if (commentTextarea) {
                commentTextarea.placeholder = "ëŒ“ê¸€ì„ ì‘ì„±í•˜ë ¤ë©´ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.";
                commentTextarea.disabled = true;
            }

            const submitBtn = form?.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.textContent = "ë¡œê·¸ì¸ í•„ìš”";
                submitBtn.onclick = (e) => {
                    e.preventDefault();
                    alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
                    location.href = "/login";
                };
            }
            return;
        }

        const submitBtn = form?.querySelector('button[type="submit"]');
        if (submitBtn) {
            submitBtn.textContent = "ë“±ë¡";  // ì›ë˜ í…ìŠ¤íŠ¸ë¡œ ë³µì›
        }

        if (commentTextarea) {
            commentTextarea.placeholder = "ëŒ“ê¸€ì„ ì…ë ¥í•´ì£¼ì„¸ìš”";
            commentTextarea.disabled = false;  // í™œì„±í™”
        }

        form?.addEventListener("submit", async (e) => {
        e.preventDefault();
        // ğŸ” ëŒ“ê¸€ ì‘ì„± ì‹œì—ë„ ë¡œê·¸ì¸ ì²´í¬
        const currentUser = await getCurrentUser();
        if (!currentUser) {
            alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            location.href = "/login";
            return;
        }
        const content = document.getElementById("commentContent").value;

        if (!content.trim()) {
            alert("ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        try {
            const res = await fetch(`/api/posts/${postId}/comments`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                credentials: 'include', // ì¿ í‚¤ í¬í•¨
                body: JSON.stringify({ content: content.trim() })
            });

            if (!res.ok) throw new Error("ëŒ“ê¸€ ë“±ë¡ ì‹¤íŒ¨");

            document.getElementById("commentContent").value = "";

            // ğŸ”¥ ëŒ“ê¸€ ë“±ë¡ í›„ ì¦‰ì‹œ í™”ë©´ ì—…ë°ì´íŠ¸
            await loadComments();
            await updatePostCounts(); // ëŒ“ê¸€ ìˆ˜ ì—…ë°ì´íŠ¸

            console.log("âœ… ëŒ“ê¸€ ë“±ë¡ ë° í™”ë©´ ì—…ë°ì´íŠ¸ ì™„ë£Œ");
        } catch (err) {
            console.error("ëŒ“ê¸€ ë“±ë¡ ì‹¤íŒ¨:", err);
            alert("ëŒ“ê¸€ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ ìƒíƒœë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
        }
    });
}

    async function loadComments() {
        try {
            const res = await fetch(`/api/posts/${postId}/comments`);
            if (!res.ok) throw new Error("ëŒ“ê¸€ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨");

            const comments = await res.json();
            if (!Array.isArray(comments)) return;

            const commentList = document.getElementById("commentList");
            commentList.innerHTML = "";

            // ğŸ” í˜„ì¬ ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
            const currentUser = await getCurrentUser();

            comments.forEach(comment => {
                const div = document.createElement("div");
                div.className = "comment";

                // ğŸ” ëŒ“ê¸€ ì‘ì„±ì ë³¸ì¸ì¸ì§€ í™•ì¸
                const isCommentOwner = currentUser &&
                    (currentUser.username === comment.userName);

                // ğŸ” ëŒ“ê¸€ ì‘ì„±ìì—ê²Œë§Œ ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ í‘œì‹œ
                const commentActionsHtml = isCommentOwner ? `
                    <div class="comment-actions">
                        <button onclick="editComment(${comment.id}, '${comment.content.replace(/'/g, "\\'")}')">ìˆ˜ì •</button>
                        <button onclick="deleteComment(${comment.id})">ì‚­ì œ</button>
                    </div>
                ` : '';

                div.innerHTML = `
                    <div class="comment-header">
                        <span class="comment-author">${comment.writer}</span>
                        <span class="comment-date">${new Date(comment.createdAt).toLocaleString()}</span>
                    </div>
                    <div id="content-${comment.id}" class="comment-content">${comment.content}</div>
                    ${commentActionsHtml}
                `;
                commentList.appendChild(div);
            });
        } catch (err) {
            console.error(err);
        }
    }

    function editComment(commentId, oldContent) {
        getCurrentUser().then(currentUser => {
            if (!currentUser) {
                alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
                location.href = "/login";
                return;
            }

            const contentElement = document.getElementById(`content-${commentId}`);
            contentElement.innerHTML = `
                <div class="comment-edit-form">
                    <textarea id="edit-input-${commentId}" rows="3">${oldContent}</textarea>
                    <div class="comment-edit-actions">
                        <button class="btn-save" onclick="submitEdit(${commentId})">ì™„ë£Œ</button>
                        <button class="btn-cancel" onclick="loadComments()">ì·¨ì†Œ</button>
                    </div>
                </div>
            `;

            // ëŒ“ê¸€ ë‚´ì˜ ê¸°ì¡´ ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
            const commentDiv = contentElement.closest(".comment");
            const actions = commentDiv.querySelector(".comment-actions");
            if (actions) actions.remove();
        });
    }

    async function submitEdit(commentId) {

        // ğŸ” ëŒ“ê¸€ ìˆ˜ì • ì œì¶œ ì‹œ ë¡œê·¸ì¸ ì²´í¬
        const currentUser = await getCurrentUser();
        if (!currentUser) {
            alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            location.href = "/login";
            return;
        }

        const newContent = document.getElementById(`edit-input-${commentId}`).value;

        if (!newContent.trim()) {
            alert("ëŒ“ê¸€ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            return;
        }

        try {
            const res = await fetch(`/api/comments/${commentId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                credentials: 'include', // ì¿ í‚¤ í¬í•¨
                body: JSON.stringify({ content: newContent.trim() })
            });

            if (!res.ok) {
                const text = await res.text();
                console.error("ìˆ˜ì • ì‹¤íŒ¨ ì‘ë‹µ:", text);
                alert("ìˆ˜ì • ì‹¤íŒ¨. ë³¸ì¸ ëŒ“ê¸€ë§Œ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
                return;
            }

            console.log("âœ… ëŒ“ê¸€ ìˆ˜ì • ì„±ê³µ, í™”ë©´ ì—…ë°ì´íŠ¸");
            await loadComments();
        } catch (err) {
            console.error("ëŒ“ê¸€ ìˆ˜ì • ì‹¤íŒ¨:", err);
            alert("ëŒ“ê¸€ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ ë°œìƒ");
        }
    }

    async function deleteComment(commentId) {
        // ğŸ” ëŒ“ê¸€ ì‚­ì œ ì‹œ ë¡œê·¸ì¸ ì²´í¬
        const currentUser = await getCurrentUser();
        if (!currentUser) {
            alert("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.");
            location.href = "/login";
            return;
        }

        if (!confirm("ëŒ“ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

        try {
            const res = await fetch(`/api/comments/${commentId}`, {
                method: 'DELETE',
                credentials: 'include' // ì¿ í‚¤ í¬í•¨
            });

            if (!res.ok) {
                throw new Error("ëŒ“ê¸€ ì‚­ì œ ì‹¤íŒ¨");
            }

            console.log("âœ… ëŒ“ê¸€ ì‚­ì œ ì„±ê³µ, í™”ë©´ ì—…ë°ì´íŠ¸ ì‹œì‘");

            // ğŸ”¥ ëŒ“ê¸€ ì‚­ì œ í›„ ì¦‰ì‹œ í™”ë©´ ì—…ë°ì´íŠ¸
            await loadComments();
            await updatePostCounts(); // ëŒ“ê¸€ ìˆ˜ ì—…ë°ì´íŠ¸

            console.log("âœ… ëŒ“ê¸€ ì‚­ì œ í›„ í™”ë©´ ì—…ë°ì´íŠ¸ ì™„ë£Œ");
        } catch (err) {
            console.error("ëŒ“ê¸€ ì‚­ì œ ì‹¤íŒ¨:", err);
            alert("ì‚­ì œ ì‹¤íŒ¨. ë³¸ì¸ ëŒ“ê¸€ë§Œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
        }
    }

    // ğŸ”¥ ê²Œì‹œê¸€ì˜ ì¢‹ì•„ìš” ìˆ˜ì™€ ëŒ“ê¸€ ìˆ˜ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•˜ëŠ” í•¨ìˆ˜
    async function updatePostCounts() {
        try {
            const res = await fetch(`/api/posts/${postId}`);
            if (!res.ok) return;

            const post = await res.json();

            // ì¢‹ì•„ìš” ìˆ˜ ì—…ë°ì´íŠ¸
            const likeCountElement = document.getElementById("likeCount");
            if (likeCountElement) {
                likeCountElement.textContent = post.likeCount || 0;
            }

            // ëŒ“ê¸€ ìˆ˜ ì—…ë°ì´íŠ¸
            const commentCountElement = document.getElementById("commentCount");
            if (commentCountElement) {
                commentCountElement.textContent = post.commentCount || 0;
            }

            console.log(`âœ… í†µê³„ ì—…ë°ì´íŠ¸ ì™„ë£Œ: ì¢‹ì•„ìš” ${post.likeCount}, ëŒ“ê¸€ ${post.commentCount}`);
        } catch (err) {
            console.error("ê²Œì‹œê¸€ í†µê³„ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:", err);
        }
    }

    document.addEventListener("DOMContentLoaded", async () => {
        await fetchPostDetail();
    });
    </script>
</th:block>
</html>